# Auto sharing Spotify track to Telegram

[English](#Description)

## –û–ø–∏—Å–∞–Ω–∏–µ

–ö–æ–≥–¥–∞ —è —Å–ª—É—à–∞—é –º—É–∑—ã–∫—É –≤ Spotify, –º–æ—è –¥–µ–≤—É—à–∫–∞ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Å–∏—Ç –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å –Ω–µ–π —Ç—Ä–µ–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π –∏–≥—Ä–∞–µ—Ç üòÅ

–í –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –º–Ω–µ –Ω–∞–¥–æ–µ–ª–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –æ—Ç–≤–ª–µ–∫–∞—Ç—å—Å—è, –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –æ–∫–Ω–æ __Spotify__ –∏ —Å–æ–≤–µ—Ä—à–∞—Ç—å –µ—â–µ —Ç–æ–Ω–Ω—É –¥–µ–π—Å—Ç–≤–∏–π, —á—Ç–æ–±—ã
–ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Ç—Ä–µ–∫–æ–º. –°–Ω–∞—á–∞–ª–∞ —ç—Ç–æ –±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ __Shortcuts.app__ –Ω–∞ __MacOS__, –Ω–æ —Ç–∞–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ
–ø–æ–∑–≤–æ–ª—è–ª–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ __Telegram-–±–æ—Ç–∞__. –≠—Ç–æ –Ω–µ —Å–ª–∏—à–∫–æ–º —É–¥–æ–±–Ω–æ –¥–ª—è –º–µ–Ω—è.
–ü–æ—ç—Ç–æ–º—É –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ä–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–≤—è–∑–∫—É __Python__, __AppleScript__ –∏ __Shortcuts.app__.

- –°–∫—Ä–∏–ø—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Ç—Ä–µ–∫ –≤ __Spotify__ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ __Telegram__ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –≤–∏–¥–µ —Å—Å—ã–ª–∫–∏;
- –°–∫—Ä–∏–ø—Ç –Ω–∞–ø–∏—Å–∞–Ω –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ __Shortcuts.app__ –Ω–∞ __MacOS__ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç __AppleScript__;
- –°–∫—Ä–∏–ø—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤ –æ—Ç—Ä—ã–≤–µ –æ—Ç __Shortcuts.app__, –∫–∞–∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π __Python__-—Å–∫—Ä–∏–ø—Ç.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª—ã –∏–∑ —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è;
2. –ü–æ–ª—É—á–∏—Ç—å __API_ID__ –∏ __API_HASH__ –æ—Ç [Telegram](https://my.telegram.org);
3. –ü–æ–ª—É—á–∏—Ç—å __TARGET_USER_ID__ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–º—É –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç—Ä–µ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ `@getmyid_bot` –≤ __Telegram
   __);
4. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Å–∫—Ä—ã—Ç—ã–π —Ñ–∞–∏ÃÜ–ª __.env.example__ –≤ __.env__: \
   `cd auto_sharing_spotify && mv .env.example .env`;
5. –ó–∞–ø–æ–ª–Ω–∏—Ç—å __API_ID__, __API_HASH__ –∏ __TARGET_USER_ID__ –≤ __.env__;
6. –°–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
    - –µ—Å–ª–∏ __Poetry__ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: \
      `python -m venv .venv && source .venv/bin/activate`;
7. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
    - –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è __Poetry__: \
      `poetry install`;
    - –µ—Å–ª–∏ –±–µ–∑ __Poetry__: \
      `pip install -r requirements.txt`;
8. –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —Å–∞–º —Å–∫—Ä–∏–ø—Ç —É–∂–µ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
    - –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é (__–Ω–µ __Shortcuts.app____): \
      `python main.py`;
    - –ë—É–¥–µ—Ç –∑–∞–ø—Ä–æ—à–µ–Ω –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–ª–∏ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—ç—Ç–æ
      –º–µ—Ö–∞–Ω–∏–∑–º—ã __Telegram__):
        1. _–µ—Å–ª–∏ —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –æ—Ç –∏–º–µ–Ω–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ (–ª–∏—á–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –∏–ª–∏
           –≤ __–ò–∑–±—Ä–∞–Ω–Ω–æ–µ__, –µ—Å–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–∞–º–æ–º—É —Å–µ–±–µ);_
        2. _–µ—Å–ª–∏ —É–∫–∞–∑–∞—Ç—å —Ç–æ–∫–µ–Ω (__@BotFather__), —Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞;_
    - –í __Telegram__ –ø—Ä–∏–¥–µ—Ç –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç __Telegram__;
    - –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞—Å—Ç—Å—è —Ñ–∞–π–ª __session.session__, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è
      –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ __Telegram__ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–≤–æ–¥–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö;
    - –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞ –±—É–¥—É—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ñ–∞–π–ª __session.session__);
9. –î–∞–ª–µ–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –≤ __Shortcuts.app__:
    - –í __Shortcuts.app__ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É;
    - –î–æ–±–∞–≤–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ "__–ó–∞–ø—É—Å—Ç–∏—Ç—å Shell-—Å–∫—Ä–∏–ø—Ç__" –∏ –≤ –ø–æ–ª–µ –≤—Å—Ç–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫–∏:
      ```bash:
      cd /path/to/auto_sharing_spotify  # –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
      source . venv/bin/activate
      python main.py
      ```
    - –í –ø—É–Ω–∫—Ç–µ "__–ü–µ—Ä–µ–¥–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ__" –≤—ã–±—Ä–∞—Ç—å: `B stdin`
    - _(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)_ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞:
        - –ï—Å–ª–∏ `–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ shell —Å–æ–¥–µ—Ä–∂–∏—Ç ERROR` (_—Ç–µ–∫—Å—Ç_), —Ç–æ... _–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ_
        - –ò–Ω–∞—á–µ... _—è –æ—Å—Ç–∞–≤–∏–ª –ø—É—Å—Ç—ã–º_
    - _(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)_ –î–æ–±–∞–≤–∏—Ç—å __–≥–æ—Ä—è—á—É—é –∫–ª–∞–≤–∏—à—É__ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ \
      _(–º–æ–∂–Ω–æ –∏ —Å –ø–æ–º–æ—â—å—é __Siri__ –≤—ã–∑—ã–≤–∞—Ç—å, –Ω–æ —ç—Ç–æ –Ω–µ —É–¥–æ–±–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ —É –º–µ–Ω—è –æ–Ω–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤—ã–ª–∞–∑–∏—Ç –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ, –∞
      –Ω–µ –Ω–∞ –Ω–æ—É—Ç–±—É–∫–µ –∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞; –∫—Ä–æ–º–µ —Ç–æ–≥–æ –æ–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–∏–≥–ª—É—à–∞–µ—Ç –∑–≤—É–∫ –∏ —ç—Ç–æ —Ç–æ–∂–µ –Ω–µ —Ç–æ,
      —á—Ç–æ —è —Ö–æ—Ç–µ–ª –±—ã)_

---

[back to top](#auto-sharing-spotify-track-to-telegram)

## Description

When I listen to music on __Spotify__, my girlfriend occasionally asks me to share the track that's currently playing üòÅ

At some point, I got tired of constantly getting distracted, opening the __Spotify__ window, and performing a bunch of
actions just to share a track. Initially, I implemented this using __Shortcuts.app__ on __macOS__, but that solution
only allowed sending messages via a __Telegram__ bot, not as personal messages.
That was inconvenient for me, so I created a solution using __Python__, __AppleScript__ and __Shortcuts.app__.

- The script fetches the currently playing track from __Spotify__ and sends it to a specified __Telegram__ user as a
  link.
- It is designed to be integrated into __Shortcuts.app__ on __macOS__ and uses __AppleScript__.
- The script can also be used independently, without __Shortcuts.app__, as a standalone __Python__ script.

## Usage

1. Download the files from this repository.
2. Get your __API_ID__ and __API_HASH__ from [Telegram](https://my.telegram.org).
3. Get the __TARGET_USER_ID__ of the recipient (for example, using `@getmyid_bot` in __Telegram__).
4. Rename the hidden file __.env.example__ to __.env__: \
   `cd auto_sharing_spotify && mv .env.example .env`;
5. Fill in the __API_ID__, __API_HASH__, and __TARGET_USER_ID__ fields in the __.env__ file.
6. Create and activate a virtual environment:
    - If __Poetry__ is not installed: \
      `python -m venv .venv && source .venv/bin/activate`;
7. Install dependencies:
    - If using __Poetry__: \
      `poetry install`;
    - If not using __Poetry__: \
      `pip install -r requirements.txt`;
8. At this point, the script is ready for use:
    - first run must be done manually (__not__ via __Shortcuts.app__): \
      `python main.py`;
    - The script will prompt for either a phone number or a bot token for authentication (__Telegram__ mechanism):
        1. If you enter a phone number, messages will be sent from your personal account (as a private message or to
           __Saved Messages__ if sending to yourself).
        2. If you enter a token (__@BotFather__), messages will be sent from a bot account.
    - A confirmation code from __Telegram__ will be sent to your __Telegram__ account.
    - After successful authentication, a __session.session__ file will be created in the project folder. This file will
      be used for future logins without requiring reauthentication.
    - Subsequent script runs will not require authentication (as long as __session.session__ exists).

9. Adding the script to __Shortcuts.app__:
    - Open __Shortcuts.app__ and create a new shortcut.
    - Add the ‚Äú__Run Shell Script__‚Äù action and enter the following:
      ```bash:
      cd /path/to/auto_sharing_spotify  # Replace with the actual path to the project
      source . venv/bin/activate
      python main.py
      ```
    - Under ‚Äú__Pass input__‚Äù, select: `stdin`.
    - (_Optional_) Add a condition based on the script's execution result:
        - If `Shell script result contains ERROR` (_text_), for example, send a notification.
        - Otherwise, leave it empty.
    - (_Optional_) Add a hotkey for quick script execution.
      _(You can also trigger it via __Siri__, but I find that inconvenient because it often activates on my phone
      instead of my Mac, preventing the command from executing. Additionally, __Siri__ lowers the volume, which is not
      ideal.)_

---

[back to top](#auto-sharing-spotify-track-to-telegram)
